<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Essential Open API - Demo</title>
    <style>
      :root {
        font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        color: #1f2937;
        background-color: #f8fafc;
      }

      body {
        margin: 0;
        padding: 2rem;
        display: flex;
        justify-content: center;
      }

      main {
        width: min(960px, 100%);
        background: #ffffff;
        border-radius: 16px;
        padding: 2.5rem;
        box-shadow: 0 25px 50px -12px rgba(15, 23, 42, 0.25);
        display: grid;
        gap: 2.5rem;
      }

      header h1 {
        margin: 0;
        font-size: 2.25rem;
        color: #0f172a;
      }

      header p {
        margin: 0.75rem 0 0;
        color: #475569;
        max-width: 720px;
      }

      section {
        display: grid;
        gap: 1.25rem;
        padding: 1.5rem;
        border: 1px solid #e2e8f0;
        border-radius: 14px;
        background: #f8fafc;
      }

      section h2 {
        margin: 0;
        font-size: 1.5rem;
        color: #1e293b;
      }

      fieldset {
        border: none;
        padding: 0;
        margin: 0;
        display: grid;
        gap: 1rem;
      }

      label {
        display: grid;
        gap: 0.35rem;
        font-weight: 600;
        color: #0f172a;
      }

      input,
      textarea {
        font: inherit;
        padding: 0.75rem 1rem;
        border-radius: 10px;
        border: 1px solid #cbd5f5;
        background: #ffffff;
        transition: border-color 160ms ease, box-shadow 160ms ease;
        box-sizing: border-box;
      }

      input:focus,
      textarea:focus {
        outline: none;
        border-color: #2563eb;
        box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.15);
      }

      button {
        font: inherit;
        padding: 0.85rem 1.6rem;
        border-radius: 999px;
        border: none;
        background: linear-gradient(135deg, #2563eb, #1d4ed8);
        color: #ffffff;
        font-weight: 600;
        cursor: pointer;
        justify-self: start;
        transition: transform 160ms ease, box-shadow 160ms ease, filter 160ms ease;
      }

      button:hover {
        transform: translateY(-1px);
        box-shadow: 0 12px 24px rgba(37, 99, 235, 0.35);
      }

      button:disabled {
        filter: grayscale(0.4);
        cursor: wait;
        box-shadow: none;
      }

      textarea {
        min-height: 200px;
        resize: vertical;
        background: #0b1120;
        color: #e2e8f0;
        font-family: "Fira Code", "SFMono-Regular", ui-monospace, "Source Code Pro", monospace;
        line-height: 1.5;
        width: 95%;
      }

      .status {
        font-size: 0.95rem;
        color: #334155;
      }

      .progress-wrapper {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 0.75rem;
      }

      .progress-track {
        flex: 1;
        position: relative;
        height: 14px;
        background: #e2e8f0;
        border-radius: 999px;
        overflow: hidden;
      }

      .progress-bar {
        position: absolute;
        inset: 0;
        width: 0;
        transition: width 200ms ease;
        background: linear-gradient(135deg, #1d4ed8, #2563eb);
      }

      .progress-value {
        font-variant-numeric: tabular-nums;
        font-weight: 600;
        color: #1e293b;
        min-width: 3ch;
        text-align: right;
      }

      .badge {
        display: inline-flex;
        align-items: center;
        padding: 0.15rem 0.6rem;
        border-radius: 999px;
        font-size: 0.85rem;
        font-weight: 600;
        background: #e2e8f0;
        color: #0f172a;
        margin-left: 0.5rem;
      }

      .badge[data-status="RUNNING"] {
        background: #f59e0b;
        color: #3f2f00;
      }

      .badge[data-status="SUCCESS"] {
        background: #22c55e;
        color: #052e16;
      }

      .badge[data-status="ERROR"] {
        background: #ef4444;
        color: #450a0a;
      }

      .api-config {
        margin-top: 1.5rem;
        display: inline-block;
      }

      .api-config label {
        display: grid;
        gap: 0.25rem;
        font-weight: 600;
        color: #0f172a;
      }

      .api-config input {
        min-width: 320px;
      }

      @media (max-width: 640px) {
        main {
          padding: 1.5rem;
        }

        section {
          padding: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <main>
      <header>
        <h1>Essential Open API - Playground</h1>
        <p>
          Use this playground to exercise the API endpoints. The section below triggers the repository publishing flow
          and monitors the status returned by the service.
        </p>
        <div class="api-config">
          <label>
            API Base URL
            <input
              id="apiBaseUrl"
              name="apiBaseUrl"
              type="url"
              value="http://127.0.0.1:5100/api"
              placeholder="http://127.0.0.1:5100/api"
            />
          </label>
        </div>
      </header>

      <section aria-labelledby="publish-title">
        <div>
          <h2 id="publish-title">Publishing</h2>
          <p class="status">
            Fill in the Essential Viewer credentials and click <strong>Publish Repository</strong>. The page polls the
            status automatically until the process finishes.
          </p>
        </div>

        <fieldset id="publishForm">
          <label>
            Essential Viewer URL
            <input
              id="viewerUrl"
              name="viewerUrl"
              type="url"
              placeholder="http://host.docker.internal:9090/essential_viewer"
              value="http://host.docker.internal:9090/essential_viewer"
            />
          </label>
          <label>
            User
            <input id="viewerUser" name="viewerUser" type="text" placeholder="alice" value="alice" />
          </label>
          <label>
            Password
            <input id="viewerPwd" name="viewerPwd" type="password" placeholder="s3cr3t" value="s3cr3t" />
          </label>
          <button id="publishBtn" type="button">Publish Repository</button>
        </fieldset>

        <div>
          <h3>Publish status <span class="badge" id="statusBadge" data-status="IDLE">IDLE</span></h3>
          <div class="progress-wrapper">
            <div class="progress-track" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
              <div class="progress-bar" id="publishProgressBar"></div>
            </div>
            <span class="progress-value" id="publishProgressValue">0%</span>
          </div>
          <textarea id="publishStatus" readonly>Waiting for publish job...</textarea>
        </div>
      </section>

      <section aria-labelledby="examples-title">
        <div>
          <h2 id="examples-title">Examples endpoint</h2>
          <p class="status">
            For reference, the block below keeps the sample behavior for
            <code>GET /api/classes/Currency/instances</code>.
          </p>
        </div>
        <button id="loadExamples">Load examples</button>
        <pre id="output">Waiting for request...</pre>
      </section>
    </main>

    <script src="api-demo.js"></script>
  </body>
</html>
